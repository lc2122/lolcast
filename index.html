<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Video Player</title>
    <style>
        #video-container {
            margin-top: 10px;
            position: absolute;
            width: 100%;
            height: 90vh;
        }

        iframe {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 90%;
        }
    </style>
</head>

<body>
    <input type="text" id="video-url" placeholder="Enter video URL">
    <button onclick="playVideo()">Play</button>
    <div id="video-container"></div>
    <script src="https://cdn.jsdelivr.net/npm/hls.js@latest"></script>
    <script>
        async function playVideo() {
            const videoUrl = document.getElementById('video-url').value;
            const resolvedUrl = await resolveUrl(videoUrl);

            if (resolvedUrl.includes('.m3u8')) {
                const video = document.createElement('video');
                video.controls = true;
                video.autoplay = true;
                const hls = new Hls();
                hls.loadSource(resolvedUrl);
                hls.attachMedia(video);
                hls.on(Hls.Events.MANIFEST_PARSED, function() {
                    video.play();
                });
                document.getElementById('video-container').innerHTML = '';
                document.getElementById('video-container').appendChild(video);
            } else {
                const iframe = document.createElement('iframe');
                iframe.src = resolvedUrl;
                iframe.width = '100%';
                iframe.height = '100%';
                document.getElementById('video-container').innerHTML = '';
                document.getElementById('video-container').appendChild(iframe);
            }
        }

        async function resolveUrl(url) {
            const response = await fetch(url);
            const data = await response.text();
            const matchUrl = data.match(/url=([^&]+)/);

            if (matchUrl !== null) {
                return decodeURIComponent(matchUrl[1]);
            } else {
                return url;
            }
        }
    </script>
</body>

</html>
